# PSU-CIDD-Malaria-Simulation

[Penn State](https://www.psu.edu/) - [Center for Infectious Disease Dynamics (CIDD)](https://www.huck.psu.edu/institutes-and-centers/center-for-infectious-disease-dynamics) - [Boni Lab](http://mol.ax/)

---

## Release Note

This version (v3.3) is developed for the Multiple-Drug-Resistant (MDR) paper. This codebase is based off Dang Nguyen Tran's v3.2 located in [this repo](https://github.com/maciekboni/PSU-CIDD-Malaria-Simulation).

This version has implemented Sporozoite Challenge codes, and a modified monthly reporter to output all mutation pair information throughout the simulation.

Under `mdr_analysis` folder, it contains several python scripts to parse output files, compute interquartile ranges for a series (default 100) of files from the same simulation settings, and create visualizations. Refer to the Jupyter Notebook `ipynb` files (named with leading numbers) to view available MDR plots.

---

## Data Files
Several tab separated values (TSV) data files are generated depending upon the reporter that is selected for use. The files listed below are based upon the `MonthlyReporter` which generates two files. File(s) are organized with group separators indicated by the sentinel value `-1111` and *n* is a zero-indexed location id.

**monthly_reporter_*n*.txt** - Summary data for the model generated at the end of each simulated month.

| Block | Column Number(s) | Description |
| ---|--- | --- |
| Summary | 1 |  Model time, number of days elapsed |
| | 2 | Model time, calendar date as system time |
| | 3 - 5 | Model time, calendar date (Year, Month, Day) |
| | 6 | Seasonal factor |
| | 7 | Treatment coverage, probability to be treated (0 - 1) |
| | 8 | Treatment coverage, probability to be treated (0 - 10) |
| | 9 | Population size |
| | 10 | Group separator |
| EIR and PfRP | 1 + (*n* * 5) | EIR by location per year |
| | 2 + (*n* * 5) | Group separator |
| | 3 + (*n* * 5) | Blood slide prevalence, PfPR < 5 |
| | 4 + (*n* * 5) | Blood slide prevalence, PfPR 2 - 2 |
| | 5 + (*n* * 5) | Blood slide prevalence, PfPr all |
| Infections by Location | 1 | Group separator |
| | 2 + *n* | Number of new infections by location |
| Treatments by Location | 1 | Group separator |
| | 2 + *n* | Number of treatments by location |
| Clinical Episodes by Location | 1 | Group separator |
| | 2 + *n* | Number of clinical episodes by location |
| Genotype Frequency | 1 | Group separator |


**summary_reporter_*n*.txt** Summary that is generated after the model has completed execution.

| Block | Column Number(s) | Description |
| --- | --- | --- |
| Summary I | 1 | Random seed value |
|  | 2 | Number of locations |
|  | 3 | *Beta* value |
|  | 4 | Population size |
| EIR and PfRP | 1 + (*n* * 5) | EIR by location per year |
| | 2 + (*n* * 5) | Group separator |
| | 3 + (*n* * 5) | Blood slide prevalence, PfPR < 5 |
| | 4 + (*n* * 5) | Blood slide prevalence, PfPR 2 - 2 |
| | 5 + (*n* * 5) | Blood slide prevalence, PfPr all |
| Summary II | 1 | Treatment strategy id |
| | 2 | Percent treatment failures per year |



---

## Genotype Information

Genotypes are encoded into the application via the input file which contains a YAML entry for `genotype_info`. This structure is organized as `loci` with the assoicated `alleles` that may be mutated during model execution. The following table outlines loci and alleles that are included in the sample configuration file.

**Outline of loci and allel encoding**

| Locus | Allele | Short Name | Description |
| --- | --- | --- | --- |
| PfCRT | K76 | K | Lumefantrine resistant; Amodiaquine sensitive |
| | 76T | T |  Lumefantrine sensitive; Amodiaquine resistant |
| PfMDR1 | N86 Y184, Single-Copy |  NY-- | Partial-Lumefantrine and Partial-Amodiaquine resistant |
| | 86Y Y184, Single-Copy | YY-- | Amodiaquine resistant |
| | N86 184F, Single-Copy | NF-- | Lumefantrine resistant |
| | 86Y 184F, Single-Copy | YF-- | Partial-Amodiaquine and Partial-Lumefantrine resistant |
| | N86 Y184, Double-Copy | NYNY | Partial-Lumefantrine and Partial-Amodiaquine resistant, higher strength; Mefloquine selects strongly for multi-copy |
| | 86Y Y184, Double-Copy | YYYY | Amodiaquine resistant, higher strength; Mefloquine selects strongly for multi-copy |
| | N86 184F, Double-Copy | NFNF | Lumefantrine resistant, higher strength; Mefloquine selects strongly for multi-copy |
| | 86Y 184F, Double-Copy | YFYF | Partial-Amodiaquine and Partial-Lumefantrine resistant, higher strength; Mefloquine selects strongly for multi-copy |
| K13 Propeller | C580 | C | Artemisinin sensitive |
| | 580Y | Y | Artemisinin resistant |
| Plasmepsin 2-3 | Plasmepsin 2-3 Single-Copy | 1 | Piperaquine sensitive |
| | Plasmepsin 2-3 Double-Copy | 2 | Piperaquine resistant |
| Hypothetical locus for multiple use | naïve | x | Experimental use in the model |
| | mutant | X | Experimental use in the model |

The short name field requires addtional note since genotype results generated by the model are based upon the short names. For example:

> KNY--C1x

Indicates that the parasite has the K76 allele from the pfcrt locus (K), N86 Y184 one copy of pfmdr1 (NY--), C580 from K13 Propeller locus (C), Plasmepsin 2-3 one copy (1), and is a naïve copy of the hypotehtical locus (x). 

---

## About

---

## Documentation

